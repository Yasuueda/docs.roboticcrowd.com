# Robotic Crowd Agentで繰り返し作業を記録する  

## 概要

Robotic Crowd Agent を使って、繰り返し作業を記録する方法を説明します。

事前に、Chrome に Robotic Crowd Agent という拡張機能をインストールしている必要があります。
インストール方法は、こちらをご覧ください。

では、始めましょう。

### このチュートリアルのゴール

今回は、SpreadSheet を事前に準備してから作成します。
弊社サイトのヘルプセンターで3つの単語を調べて、それぞれ検索結果がもっとも上に出てきた記事のタイトルを取得します。

### 作業

手順  

1. SpreadSheet の準備をする
1. レコーディングを開始するサイトを開く
1. Robotic Crowd Agent のポップアップを表示して、RECボタンでレコーディングを開始する
1. ブラウザで操作する
1. SpreadSheet に反映されていることを確認する

### 1. SpreadSheet の準備をする

SpreadSheet の準備をします。
「検索文字」と「タイトル」というヘッダーを準備してください。
今回は検索文字に「RPA」「CSS」「繰り返し」の3つを設定します。

![spreadsheet準備](./repeat1.png)


### 2. レコーディングを開始するサイトを開く

株式会社チュートリアルのヘルプセンターのページにいき、Robotic Crowd Agentを起動します。  
これまで同様、右上の猫のマークをクリックして起動してください。
そのあと、"REC"ボタンをクリックしてrecordingを開始してください。

![nekoclick](./repeat2.png)  

### 3. Robotic Crowd Agent のポップアップを表示して、RECボタンでレコーディングを開始する

### 4. ブラウザで操作する

recordingを開始しましたら、ページ左上の何もない場所をクリックしてください。(ページ左上にする理由はアクション一覧が見やすいからです)  

クリックすると、アクション一覧が表示されます。  
今回は「繰り返す」というアクションを選択してください。  

![繰り返すボタン](./repeat3.png)

「繰り返す」というアクションをクリックすると画面がでてきます。CSVとSPREADSHEETの2つがありますが、今回使用するSPREADSHEETの方を選択してください。  
選択すると、SpreadSheetのリンクを貼る場所が出てきますので先ほど作成したSpreadSheetのリンクを貼り付けてください。  
貼り付けましたら、リンク横のダウンロードボタンをクリックして、SpreadSheetを読み込ませてください。  

![リンク読み込み](./repeat4.png)  

SpreadSheetを読み込ませると、次の画面が出てきます。  
この画面は、いわゆる繰り返しに必要のないデータを取り除く作業です。  
セルの部分にカーソルを合わせると、「この行の値を削除する」という文字が出てきます。
今回の作業で繰り返しに必要のないものは、ヘッダー部分の「検索文字」と「タイトル」です。したがって、一番上の行にカーソルを合わせてクリックしてください。
クリックできましたら、OKボタンを押してください。  

![繰り返し範囲設定](./repeat5.png)  

OKボタンを押すと、元の画面に戻ってきます。  
回答を検索する...をクリックしてください。文字を入力できる部分が出てきます。

文字を入力する右の部分にある、四角形のマークの「読み込んだ表の値を使う」をクリックしてください。

![テキスト入力](./repeat6.png)  

クリックすると、下のような画面が出てきます。  
検索文字の欄にカーソルを合わせてクリックしてください。

![テキスト入力文字一覧](./repeat7.png)  

検索したいので、虫眼鏡のマークをクリックしてください。  
アクション一覧が表示されますので、「クリック」を選択してください。  

![検索ボタン](./repeat8.png)  

ページが遷移します。
RPAと検索して表示された、一番上の記事の取得をします。  
タイトルの部分をクリックしてください。するとアクション一覧が表示されるので、「テキストを取得」というアクションを選択してください。

![タイトルテキスト取得](./repeat9.png)  

一回元の画面に戻りますが、再び一番上の記事のタイトル部分をクリックしてください。  
アクション一覧が表示されますので、「スプレッドシートのセルの値を更新」というアクションを選択してください。  

![セルの値を更新](./repeat10.png)  

下のような画面が出てきます。  
SpreadSheeetのURLを取得して、貼り付けてください。  
貼り付けたら、右に出てくるダウンロードボタンをクリックしてください。  

![URL貼り付け](./repeat11.png)  

次の画面が出てきます。
Valuesの中身を取得しましょう。右の四角形のボタンをクリックしてください。  

![Values取得](./repeat12.png)  

下のような画面が出てきます。  
記事のタイトルと同じものがリストの中にありますので、そこの部分をクリックしてください。  

![Values入力](./repeat13.png)  

次はRangeの範囲を設定していきます。  
Rangeの右側にある四角形のボタンをクリックしてください。  

![Range取得](./repeat14.png)  

値を入力していく範囲を設定していきます。  
RPAと検索して出てきたタイトルの部分から下に入力していきたいので、RPAの右隣のセルをクリックしてください。  

![Range入力](./repeat15.png)  

ValuesとRangeが入力されていることが分かります。  

![入力確認](./repeat16.png)  

操作はここまでで終了です。

### 5. SpreadSheet に反映されていることを確認する

recordingを終了させましょう。  
猫のマークをクリックして、"STOP"を押してください。  

"PLAY"をクリックして、実際に動かしてみましょう。

![最終確認](./repeat17.png)  

RPAロボットが動き、検索していることが分かります。  
最後にSpreadSheetを確認してみましょう。  
SpreadSheetのタイトル欄に記事のタイトルが入力されています。  

![セル確認](./repeat18.png)  

今回は、繰り返し作業を記録する方法を解説しました。  
