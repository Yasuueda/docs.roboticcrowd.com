# スケジュール

作成したワークフローは、スケジュールを登録することによって定期的に実行させることができます。ここでは、スケジュールの登録の方法とスケジュールの動作について説明します。

＊現在（2019年6月時点）、スケジュールの刻みは10分台毎となっています。例えば、10時15分と設定したスケジュールは、10時20分に実行されます。

## スケジュールの動作

スケジュール設定されると、指定時刻に実行キューに登録を試みます。実行キューに追加されると直ちに実行が試行されますが、実行できなかった場合は、キューのままロボットの空きを待ちます。通知設定されていると、キューのままロボットの空きを待つ状態になったら通知先にメールで通知が送信されます。

## 設定項目

スケジュールでは、次の項目を設定できます。

<table>
  <thead>
    <tr>
      <th style="text-align:left">&#x8A2D;&#x5B9A;&#x9805;&#x76EE;</th>
      <th style="text-align:left">&#x5185;&#x5BB9;</th>
      <th style="text-align:left">&#x4F8B;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left">&#x30EF;&#x30FC;&#x30AF;&#x30D5;&#x30ED;&#x30FC;</td>
      <td style="text-align:left">&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x5B9F;&#x884C;&#x3059;&#x308B;&#x30EF;&#x30FC;&#x30AF;&#x30D5;&#x30ED;&#x30FC;&#x3067;&#x3059;&#x3002;&#x30D7;&#x30EB;&#x30C0;&#x30A6;&#x30F3;&#x3067;&#x9078;&#x629E;&#x3057;&#x307E;&#x3059;&#x3002;</td>
      <td
      style="text-align:left">&#x300C;&#x4F1A;&#x8B70;&#x5BA4;&#x4E88;&#x7D04;&#x300D;</td>
    </tr>
    <tr>
      <td style="text-align:left">CRON</td>
      <td style="text-align:left">&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x5B9F;&#x884C;&#x3092;&#x5B9A;&#x7FA9;&#x3059;&#x308B;&#x6587;&#x5B57;&#x5217;&#x3067;&#x3059;&#x3002;CRON&#x5F62;&#x5F0F;&#x3067;&#x8A18;&#x8FF0;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;</td>
      <td
      style="text-align:left">
        <p>0/20 9-17 <em> </em> MON,TUE,WED,THU,FRI</p>
        <p>&#xFF0A;&#x5E73;&#x65E5; 9&#x6642;&#x53F0;&#x304B;&#x3089;17&#x6642;&#x53F0;&#x306B;20&#x5206;&#x7F6E;&#x304D;&#x306B;&#x5B9F;&#x884C;</p>
        </td>
    </tr>
    <tr>
      <td style="text-align:left">&#x901A;&#x77E5;&#x5148;</td>
      <td style="text-align:left">&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x5B9F;&#x884C;&#x304C;&#x30ED;&#x30DC;&#x30C3;&#x30C8;&#x306E;&#x7A7A;&#x304D;&#x304C;&#x306A;&#x304F;&#x5B9F;&#x884C;&#x9045;&#x5EF6;&#x304C;&#x767A;&#x751F;&#x3057;&#x305F;&#x5834;&#x5408;&#x306B;&#x901A;&#x77E5;&#x3092;&#x9001;&#x308B;&#x5148;&#x3067;&#x3059;&#x3002;&#x30B3;&#x30E9;&#x30DC;&#x30EC;&#x30FC;&#x30BF;&#x30FC;&#x306E;&#x4E2D;&#x304B;&#x3089;&#x9078;&#x629E;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;&#x8907;&#x6570;&#x540D;&#x767B;&#x9332;&#x3067;&#x304D;&#x307E;&#x3059;&#x3002;</td>
      <td
      style="text-align:left">john@example.com</td>
    </tr>
  </tbody>
</table>### CRONについて

CRON形式は、汎用性の高い記述形式ではありますが、独特なフォーマットを覚える必要があり初めて利用される方にはハードルが高い記述形式です。Robotic Crowd では、CRONを直接記述することなく、何月？何日？何時？何分？と言う形式で簡単に設定することも可能です。

例えば、フォームに次のように入力してみましょう。

![&#x30B9;&#x30B1;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x8A2D;&#x5B9A;](../.gitbook/assets/screen-shot-2019-06-07-at-15.28.54%20%281%29.png)

一つずつ説明してきます。

何月？と言うところにアスタリスク（\*）が入力されています。これは、全ての月と言うことを意味しています。次に、何日？と言うところに25と入っているので、25日が設定されます。ここまでで、「毎月25日に」と言う設定になっています。その次の何時？と言うところには、10と入力されているので、午前10時が設定されます。同様に何分？と言うところは、0分（つまり10時ちょうどですね）、何曜日？には全ての曜日がチェックされています。25日が何曜日であっても実行すると言う設定です。

この設定は、「毎月25日の午前10時丁度に実行する」と言うスケジュール設定になります。ダイアログに下部に「次の10件のスケジュールを確認」と言うボタンがあるので、クリックして実行予定を確認します。確認の実行結果は、現在日時より後の10件を表示します。

`2019-06-25 火 10:00  
2019-07-25 木 10:00  
2019-08-25 日 10:00  
2019-09-25 水 10:00  
2019-10-25 金 10:00  
2019-11-25 月 10:00  
2019-12-25 水 10:00  
2020-01-25 土 10:00  
2020-02-25 火 10:00   
2020-03-25 水 10:00`

ここで、思った通りにスケジュールが実行されているか確認できます。

CRON形式は、スペースを区切りとして `[分] [時] [日] [月] [曜日]` を設定していきます。カンマ `,` で区切ることで複数の値を設定できます。次のセクションでは高度なスケジュール設定について解説します。

### 高度なスケジュール

#### 特定の範囲の時間で実行する

特定の範囲で実行したい場合、例えば、営業時間内の 9時から17時までの間と言う設定であれば、 `9-17` とすればスケジュールを設定できます。ここで設定している数字は、9時台、17時台と言う設定ですので、例えば、17時20分の実行は不要と言うことであれば、 `9-16` とすれば良いです。

#### 間隔を開けて実行する

例えば、各時刻のちょうどの時間から20分毎に実行したい場合は、 `0/20` とすることで設定できます。 `[初めの値]/[間隔]` と言う書式です。しかし、Robotic Crowdで現在、サポートしている実行時刻は、0分、10分、20分、30分... と10分置きですので、例えば、 `0/15` と言う設定をすると、0分、20分、30分、50分に実行されてしまいますのでご承知おきください。

#### いくつかピンポイントで指定する

カンマ `,` で区切ると指定できます。例えば、5時、6時、13時に実行する場合は、 `5,6,13` とすれば良いです。

#### 例

平日の13時から14時、16時から17時台の30分、五十日、1月3月5月7月8月10月12月で曜日は問わないとするCRONは、次のようになります。

 `30 13-14,16-17 5-29/5,31 1,3,5,7,8,10,12 *` 

となります。次の10件のスケジュールを確認すると、

```text
2019-07-05 金 13:30
2019-07-05 金 14:30
2019-07-05 金 16:30
2019-07-05 金 17:30
2019-07-10 水 13:30
2019-07-10 水 14:30
2019-07-10 水 16:30
2019-07-10 水 17:30
2019-07-15 月 13:30
2019-07-15 月 14:30
```

となっています。

